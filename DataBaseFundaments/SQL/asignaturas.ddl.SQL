--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 6.1.787
--   Created On : jueves, 12 abril, 2018 
--   DBMS       : Oracle 
--   -------------------------------------------------- 



--  Drop Tables 
DROP TABLE Asignatura CASCADE CONSTRAINTS
;
DROP TABLE Asignatura_prerequisito CASCADE CONSTRAINTS
;
DROP TABLE Docente CASCADE CONSTRAINTS
;
DROP TABLE Espacio_academico CASCADE CONSTRAINTS
;
DROP TABLE Espacio_docente CASCADE CONSTRAINTS
;
DROP TABLE Espacio_estudiante CASCADE CONSTRAINTS
;
DROP TABLE Estudiante CASCADE CONSTRAINTS
;
DROP TABLE Horario CASCADE CONSTRAINTS
;
DROP TABLE Horario_espacio CASCADE CONSTRAINTS
;
DROP TABLE Proy_asignatura CASCADE CONSTRAINTS
;
DROP TABLE Proyecto_curricular CASCADE CONSTRAINTS
;
DROP TABLE Salon CASCADE CONSTRAINTS
;
DROP TABLE Salon_espacio CASCADE CONSTRAINTS
;
DROP TABLE Sede CASCADE CONSTRAINTS
;

--  Create Tables 
CREATE TABLE Asignatura ( 
	id_asignatura VARCHAR(15) NOT NULL,
	nombre_asignatura VARCHAR(25) NOT NULL,
	codigo_ea VARCHAR(20) NOT NULL,
	nivel NUMBER(2) NOT NULL
)
;

CREATE TABLE Asignatura_prerequisito ( 
	id_asignatura VARCHAR(15) NOT NULL,
	id_prerequisito VARCHAR(15) NOT NULL
)
;

CREATE TABLE Docente ( 
	cedula VARCHAR(25) NOT NULL,
	nombre VARCHAR(25) NOT NULL,
	apellido VARCHAR(25)
)
;
COMMENT ON TABLE Docente
    IS 'Persona encargada de dictar el espacio academico '
;

CREATE TABLE Espacio_academico ( 
	codigo_ea VARCHAR(20) NOT NULL    --  Codigo del espacio academico 
)
;
COMMENT ON TABLE Espacio_academico
    IS 'Espacio donde se dicta una asignatura 
 '
;

COMMENT ON COLUMN Espacio_academico.codigo_ea
    IS 'Codigo del espacio academico'
;

CREATE TABLE Espacio_docente ( 
	codigo_ea VARCHAR(20) NOT NULL,
	cedula VARCHAR(25) NOT NULL
)
;

CREATE TABLE Espacio_estudiante ( 
	codigo_estudiante VARCHAR(25) NOT NULL,
	codigo_ea VARCHAR(20) NOT NULL
)
;

CREATE TABLE Estudiante ( 
	codigo_es VARCHAR(25) NOT NULL,
	id_estudiante NUMBER(11) NOT NULL,
	nombre VARCHAR(30) NOT NULL,
	apellido VARCHAR(30) NOT NULL
)
;
COMMENT ON TABLE Estudiante
    IS 'Persona que cursa los espacios academicos '
;

CREATE TABLE Horario ( 
	fecha DATE NOT NULL,    --    
	hora DATE NOT NULL    --  Hora a la que se dicta el espacio academico  
)
;
COMMENT ON TABLE Horario
    IS 'Lugar y hora donde se dicta un espacio academico '
;

COMMENT ON COLUMN Horario.fecha
    IS ' '
;

COMMENT ON COLUMN Horario.hora
    IS 'Hora a la que se dicta el espacio academico '
;

CREATE TABLE Horario_espacio ( 
	codigo_ea VARCHAR(20) NOT NULL,
	hora DATE NOT NULL
)
;

CREATE TABLE Proy_asignatura ( 
	id_asignatura VARCHAR(15) NOT NULL,
	nombre VARCHAR(25) NOT NULL
)
;

CREATE TABLE Proyecto_curricular ( 
	nombre VARCHAR(25) NOT NULL
)
;

CREATE TABLE Salon ( 
	codigo VARCHAR(15) NOT NULL,
	tipo VARCHAR(15) NOT NULL,
	cupos NUMBER(2) NOT NULL,
	nombre VARCHAR(25)
)
;

CREATE TABLE Salon_espacio ( 
	codigo_salon VARCHAR(15) NOT NULL,
	codigo_ea VARCHAR(20) NOT NULL
)
;

CREATE TABLE Sede ( 
	nombre VARCHAR(25) NOT NULL,    --  nombre de la sede 
	direccion VARCHAR(25) NOT NULL    --  Direccion de la sede 
)
;
COMMENT ON TABLE Sede
    IS 'Sede de una universidad'
;

COMMENT ON COLUMN Sede.nombre
    IS 'nombre de la sede'
;

COMMENT ON COLUMN Sede.direccion
    IS 'Direccion de la sede'
;


--  Create Primary Key Constraints 
ALTER TABLE Asignatura ADD CONSTRAINT PK_Asignatura 
	PRIMARY KEY (id_asignatura, codigo_ea)
;

ALTER TABLE Asignatura_prerequisito ADD CONSTRAINT PK_Asignatura_prerequisito 
	PRIMARY KEY (id_asignatura, id_prerequisito)
;

ALTER TABLE Docente ADD CONSTRAINT PK_Docente 
	PRIMARY KEY (cedula)
;

ALTER TABLE Espacio_academico ADD CONSTRAINT PK_Espacios Academicos 
	PRIMARY KEY (codigo_ea)
;

ALTER TABLE Espacio_docente ADD CONSTRAINT PK_Espacio_Docente 
	PRIMARY KEY (codigo_ea, cedula)
;

ALTER TABLE Espacio_estudiante ADD CONSTRAINT PK_Espacio_Estudiante 
	PRIMARY KEY (codigo_estudiante, codigo_ea)
;

ALTER TABLE Estudiante ADD CONSTRAINT PK_Estudiante 
	PRIMARY KEY (codigo_es)
;

ALTER TABLE Horario ADD CONSTRAINT PK_Horario 
	PRIMARY KEY (hora)
;

ALTER TABLE Horario_espacio ADD CONSTRAINT PK_Horario_Espacio 
	PRIMARY KEY (codigo_ea, hora)
;

ALTER TABLE Proy_asignatura ADD CONSTRAINT PK_Proyecto_Asignatura 
	PRIMARY KEY (id_asignatura, nombre)
;

ALTER TABLE Proyecto_curricular ADD CONSTRAINT PK_Proyecto_Curricular 
	PRIMARY KEY (nombre)
;

ALTER TABLE Salon ADD CONSTRAINT PK_Table1 
	PRIMARY KEY (codigo)
;

ALTER TABLE Salon_espacio ADD CONSTRAINT PK_Salon_Espacio 
	PRIMARY KEY (codigo_salon, codigo_ea)
;

ALTER TABLE Sede ADD CONSTRAINT PK_Sede 
	PRIMARY KEY (nombre)
;




--  Create Foreign Key Constraints 
ALTER TABLE Asignatura_prerequisito ADD CONSTRAINT FK_Asignatura_prere_Asignatura 
	FOREIGN KEY (id_asignatura, id_prerequisito) REFERENCES Asignatura (id_asignatura, codigo_ea)
;

ALTER TABLE Espacio_academico ADD CONSTRAINT FK_Espacio_acade_Salon_espacio 
	FOREIGN KEY (codigo_ea) REFERENCES Salon_espacio (codigo_salon, codigo_ea)
;

ALTER TABLE Espacio_academico ADD CONSTRAINT FK_Espacio_academic_Asignatura 
	FOREIGN KEY (codigo_ea) REFERENCES Asignatura (id_asignatura, codigo_ea)
;

ALTER TABLE Espacio_docente ADD CONSTRAINT FK_Espacio_docen_Espacio_acade 
	FOREIGN KEY (codigo_ea) REFERENCES Espacio_academico (codigo_ea)
;

ALTER TABLE Espacio_docente ADD CONSTRAINT FK_Espacio_docente_Docente 
	FOREIGN KEY (cedula) REFERENCES Docente (cedula)
;

ALTER TABLE Espacio_estudiante ADD CONSTRAINT FK_Espacio_estud_Espacio_acade 
	FOREIGN KEY (codigo_ea) REFERENCES Espacio_academico (codigo_ea)
;

ALTER TABLE Espacio_estudiante ADD CONSTRAINT FK_Espacio_estudian_Estudiante 
	FOREIGN KEY (codigo_estudiante) REFERENCES Estudiante (codigo_es)
;

ALTER TABLE Horario_espacio ADD CONSTRAINT FK_Horario_espac_Espacio_acade 
	FOREIGN KEY (codigo_ea) REFERENCES Espacio_academico (codigo_ea)
;

ALTER TABLE Horario_espacio ADD CONSTRAINT FK_Horario_espacio_Horario 
	FOREIGN KEY (hora) REFERENCES Horario (hora)
;

ALTER TABLE Proy_asignatura ADD CONSTRAINT FK_Proy_asignatu_Proyecto_curr 
	FOREIGN KEY (nombre) REFERENCES Proyecto_curricular (nombre)
;

ALTER TABLE Proy_asignatura ADD CONSTRAINT FK_Proy_asignatura_Asignatura 
	FOREIGN KEY (id_asignatura) REFERENCES Asignatura (id_asignatura, codigo_ea)
;

ALTER TABLE Salon ADD CONSTRAINT FK_Salon_Sede 
	FOREIGN KEY (nombre) REFERENCES Sede (nombre)
;

ALTER TABLE Salon_espacio ADD CONSTRAINT FK_Salon_espacio_Salon 
	FOREIGN KEY (codigo_salon) REFERENCES Salon (codigo)
;
